# Тестовое задание: Классификация намерений для чат-бота

**Время выполнения:** 1.5 часа  
**Цель:** Построить модель классификации пользовательских запросов для сервиса доставки еды  

## Данные
Файл `intent_dataset.csv` содержит 110 примеров с двумя колонками:
- `text`: Пользовательские сообщения (с опечатками, сленгом и эмоциональными выражениями)
- `intent`: Категория намерения:
  - `order` - Заказ еды  
  - `cancel` - Отмена заказа  
  - `payment` - Оплата  
  - `complaint` - Жалоба  
  - `other` - Другие вопросы  

**Особенности данных:**  
- Несбалансированные классы (~18-27% каждый)  
- Реалистичные пользовательские формулировки  
- Намеренно добавлены опечатки и сленг  

## Задачи

### 1. Экспресс-анализ (10 мин)
- Загрузите данные
- Проведите базовый EDA: 
  - Распределение классов
  - Средняя длина текстов
  - Частотность слов
- Предложите стратегию обработки дисбаланса (без реализации)

### 2. Классическая модель (25 мин)
- Постройте пайплайн `TF-IDF + LogisticRegression/SVM`:
  - Разделите данные на train/test (80/20) с сохранением стратификации
  - Векторизуйте текст с помощью TF-IDF
  - Обучите модель с учетом дисбаланса классов
- Оцените качество:
  - Используйте **F1-macro** как основную метрику
  - Выведите classification report
  - Проанализируйте confusion matrix

### 3. Нейросетевая модель (35 мин)
- Используйте предобученные BERT-эмбеддинги:
  - Выберите легкую модель (напр. `sentence-transformers/all-MiniLM-L6-v2`)
  - Преобразуйте тексты в векторные представления
- Постройте классификатор:
  - Простой вариант: LogisticRegression поверх эмбеддингов
  - Опционально: 1-2 Dense слоя на PyTorch/TensorFlow
- Сравните результаты с классической моделью:
  - Где нейросетевая модель дает наибольший прирост качества?
  - Как обрабатывает опечатки и сленг?

### 4. Анализ и улучшения (10 мин)
- Сравните обе модели:
  - Какие классы чаще всего путают? Почему?
  - Приведите примеры запросов, где модели ошибаются
- Предложите 2 практических улучшения для production:
  - Идеи по обработке edge-кейсов (напр. "Отмените оплату")
  - Как интегрировать RAG-контекст (меню/правила)?

## Требования к коду
- Используйте Python (Jupyter/Colab)
- Разрешено использовать любые библиотеки (sklearn, transformers, pandas)
- Пишите лаконичный код с комментариями:
  ```python
  # Выбор мини-модели BERT для скорости инференса
  model = SentenceTransformer('all-MiniLM-L6-v2')